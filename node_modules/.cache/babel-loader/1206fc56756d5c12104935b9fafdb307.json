{"ast":null,"code":"var _jsxFileName = \"/home/iivanova/Desktop/UBC_2021_2022/CPSC547_information_visualization/project/explorify/src/PlainCalendarHeatmap.js\";\nimport React from \"react\";\nimport CalendarHeatmap from \"react-calendar-heatmap\";\nimport 'react-calendar-heatmap/dist/styles.css';\nimport * as d3 from 'd3';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction groupBy(rawData, key) {\n  return rawData.reduce(function (previousVal, currentVal) {\n    (previousVal[currentVal[key]] = previousVal[currentVal[key]] || []).push(currentVal);\n    return previousVal;\n  }, {});\n}\n\n;\n\nfunction parseMilisec(ms) {\n  let h = Math.floor(ms / 1000 / 60 / 60);\n  let m = Math.floor(ms / 1000 / 60 / 60);\n  let s = Math.floor(ms / 1000 / 60 / 60);\n}\n\nconst PlainCalendarHeatmap = () => {\n  const data = require(\"./data/StreamingHistoryDesi.json\");\n\n  const rawData = data.map(function (elem) {\n    let entry = {};\n    entry.date = elem.endTime.split(\" \")[0];\n    entry.msPlayed = elem.msPlayed;\n    return entry;\n  });\n  const startDate = rawData[0].date;\n  const endDate = rawData[rawData.length - 1].date;\n  let filteredData = Object.values(groupBy(rawData, \"date\"));\n  let streamingData = filteredData.map(function (day) {\n    let date = day[0][\"date\"];\n    day = day.reduce(function (prev, cur) {\n      prev[\"totalTracks\"] = prev[\"totalTracks\"] + 1;\n      prev[\"count\"] = prev[\"count\"] + cur[\"msPlayed\"];\n      return prev;\n    }, {\n      \"totalTracks\": 0,\n      \"count\": 0,\n      \"details\": [],\n      \"summary\": [{\n        \"name\": \"test\"\n      }]\n    });\n    day.date = date;\n    return day;\n  });\n  const minMax = d3.extent(streamingData, function (d) {\n    return d.count;\n  });\n  const binSize = Math.floor((minMax[1] - minMax[0]) / 7);\n  streamingData = streamingData.map(function (entry) {\n    entry.color = Math.floor(entry.count / binSize) + 1;\n    entry.listeningHours = date.toString();\n    return entry;\n  });\n  console.log(streamingData);\n  return /*#__PURE__*/_jsxDEV(CalendarHeatmap, {\n    values: streamingData,\n    classForValue: value => {\n      if (!value) {\n        return \"color-empty\";\n      }\n\n      return `color-scale-${value.color}`;\n    },\n    onClick: value => {\n      if (value) {\n        console.log(`Clicked on value with count: ${value.count}, ${value.color}`);\n      }\n    },\n    startDate: startDate,\n    endDate: endDate,\n    showWeekdayLabels: true,\n    tooltipDataAttrs: value => {\n      return {\n        \"data-tip\": `${value.listeningHours}`\n      };\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n};\n\n_c = PlainCalendarHeatmap;\nexport default PlainCalendarHeatmap;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlainCalendarHeatmap\");","map":{"version":3,"sources":["/home/iivanova/Desktop/UBC_2021_2022/CPSC547_information_visualization/project/explorify/src/PlainCalendarHeatmap.js"],"names":["React","CalendarHeatmap","d3","groupBy","rawData","key","reduce","previousVal","currentVal","push","parseMilisec","ms","h","Math","floor","m","s","PlainCalendarHeatmap","data","require","map","elem","entry","date","endTime","split","msPlayed","startDate","endDate","length","filteredData","Object","values","streamingData","day","prev","cur","minMax","extent","d","count","binSize","color","listeningHours","toString","console","log","value"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport CalendarHeatmap from \"react-calendar-heatmap\";\nimport 'react-calendar-heatmap/dist/styles.css';\nimport * as d3 from 'd3';\n\nfunction groupBy(rawData, key) {\n    return rawData.reduce(function(previousVal, currentVal) {\n        (previousVal[currentVal[key]] = previousVal[currentVal[key]] || []).push(currentVal);\n        return previousVal;\n    }, {});\n};\n\nfunction parseMilisec(ms){\n    let h = Math.floor(ms / 1000 / 60 / 60);\n    let m = Math.floor(ms / 1000 / 60 / 60);\n    let s = Math.floor(ms / 1000 / 60 / 60);\n\n}\n\nconst PlainCalendarHeatmap = () => {\n    const data = require(\"./data/StreamingHistoryDesi.json\");\n    const rawData = data.map(function (elem) {\n        let entry = {}\n        entry.date = elem.endTime.split(\" \")[0];\n        entry.msPlayed = elem.msPlayed;\n        return entry;\n    });\n\n    const startDate = rawData[0].date;\n    const endDate = rawData[rawData.length - 1].date;\n\n    let filteredData = Object.values(groupBy(rawData, \"date\"));\n\n    let streamingData = filteredData.map(function (day) {\n        let date = day[0][\"date\"];\n        day = day.reduce(function (prev, cur) {\n            prev[\"totalTracks\"] = prev[\"totalTracks\"] + 1;\n            prev[\"count\"] = prev[\"count\"] + cur[\"msPlayed\"];\n            return prev;\n        }, {\"totalTracks\": 0, \"count\": 0, \"details\": [], \"summary\": [{\"name\": \"test\"}]});\n        day.date = date;\n        return day;\n    });\n\n    const minMax = d3.extent(streamingData, function(d) { return d.count})\n    const binSize = Math.floor((minMax[1] - minMax[0]) / 7)\n    streamingData = streamingData.map(function (entry){\n        entry.color = Math.floor(entry.count / binSize) + 1\n        entry.listeningHours = date.toString()\n        return entry;\n    })\n\n    console.log(streamingData);\n\n    return(\n        <CalendarHeatmap\n            values={streamingData}\n            classForValue={(value) => {\n                 if (!value) {\n                     return \"color-empty\";\n                 }\n                 return `color-scale-${value.color}`;\n            }}\n            onClick={(value) => {\n                 if (value) {\n                     console.log(`Clicked on value with count: ${value.count}, ${value.color}`)\n                 }\n            }}\n            startDate={startDate}\n            endDate={endDate}\n            showWeekdayLabels={true}\n            tooltipDataAttrs={(value)=>{\n                return {\n                    \"data-tip\": `${value.listeningHours}`\n                }\n            }}\n        >\n        </CalendarHeatmap>\n    )\n\n}\nexport default PlainCalendarHeatmap;"]},"metadata":{},"sourceType":"module"}